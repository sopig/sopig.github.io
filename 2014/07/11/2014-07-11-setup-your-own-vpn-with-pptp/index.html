<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Setup Your Own VPN With PPTP · xiao</title><meta name="description" content="A Blog Powered By Hexo"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/jekyll.css"><!--[if lt IE 9]>
<script src="js/html5shiv.min.js"></script>
<script src="js/respond.min.js"></script>
<![endif]--></head><body><header class="row-flex-row limit-width vh-center"><a href="/" class="logo"><img src="/favicon.png"></a><nav><ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-link">Home</a></li><li class="nav-list-item"><a href="/archives/" class="nav-link active">   Blog</a></li><li class="nav-list-item"><a href="/atom.xml" class="nav-link">rss</a></li></ul></nav></header><div class="container limit-width"><section class="row-flex-row"><div class="post"><article class="post-block"><h2 class="post-title"><a href="/2014/07/11/2014-07-11-setup-your-own-vpn-with-pptp/" class="post-title-link">Setup Your Own VPN With PPTP</a></h2><div class="post-meta"><ul class="post-tag-list"><li class="post-tag-item"><a href="/tags/VPN/" class="post-tag-link">VPN</a></li></ul><div class="post-time">Friday, July 11th 2014</div></div><div class="post-content"><p>博主买的DigitalOcean的VPS服务，在配置好SSH远程访问后，准备继续配置pptp来搭建VPN科学上网。DO官网有详细的<a href="https://www.digitalocean.com/community/tutorials/how-to-setup-your-own-vpn-with-pptp" target="_blank" rel="external">配置教程</a>  </p>
<p>PS:这里附上我的优惠链接，你用这个链接注册可以获得10美元：<a href="https://www.digitalocean.com/?refcode=2c163841a4f4" target="_blank" rel="external">https://www.digitalocean.com/?refcode=2c163841a4f4</a>  </p>
<p>但是一步一步配置效率较低，多亏了脚本<a href="http://yansu.org/2013/12/11/deploy-pptp-vpn-in-ubuntu.html" target="_blank" rel="external">http://yansu.org</a><br><a id="more"></a></p>
<p>脚本虽然方便，但是需要改动几个地方，比如你可以设定你喜欢的<code>remoteip</code>范围，这样就可以调整你的VPN分配的IP范围；还可以添加可以使用VPN的自定义账户密码，下面是我修改过的脚本，里面添加了两个账户：yulingtianxia和802，每行四个参数分别是账户名、服务类型、密码和验证IP：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div></pre></td><td class="code"><pre><div class="line">#!/bin/sh</div><div class="line">if [ `id -u` -ne 0 ] </div><div class="line">then</div><div class="line">  echo &quot;please run it by root&quot;</div><div class="line">  exit 0</div><div class="line">fi</div><div class="line"> </div><div class="line">apt-get -y update</div><div class="line"> </div><div class="line">apt-get -y install pptpd || &#123;</div><div class="line">  echo &quot;could not install pptpd&quot; </div><div class="line">  exit 1</div><div class="line">&#125;</div><div class="line"> </div><div class="line">cat &gt;/etc/ppp/options.pptpd &lt;&lt;END</div><div class="line">name pptpd</div><div class="line">refuse-pap</div><div class="line">refuse-chap</div><div class="line">refuse-mschap</div><div class="line">require-mschap-v2</div><div class="line">require-mppe-128</div><div class="line">ms-dns 8.8.8.8</div><div class="line">ms-dns 8.8.4.4</div><div class="line">proxyarp</div><div class="line">lock</div><div class="line">nobsdcomp </div><div class="line">novj</div><div class="line">novjccomp</div><div class="line">nologfd</div><div class="line">END</div><div class="line"> </div><div class="line">cat &gt;/etc/pptpd.conf &lt;&lt;END</div><div class="line">option /etc/ppp/options.pptpd</div><div class="line">logwtmp</div><div class="line">localip 192.168.2.1</div><div class="line">remoteip 192.168.2.10-100</div><div class="line">END</div><div class="line"> </div><div class="line">cat &gt;&gt; /etc/sysctl.conf &lt;&lt;END</div><div class="line">net.ipv4.ip_forward=1</div><div class="line">END</div><div class="line"> </div><div class="line">sysctl -p</div><div class="line"> </div><div class="line">iptables-save &gt; /etc/iptables.down.rules</div><div class="line"> </div><div class="line">iptables -t nat -A POSTROUTING -s 192.168.2.0/24 -o eth0 -j MASQUERADE</div><div class="line"> </div><div class="line">iptables -I FORWARD -s 192.168.2.0/24 -p tcp --syn -i ppp+ -j TCPMSS --set-mss 1300</div><div class="line"> </div><div class="line">iptables-save &gt; /etc/iptables.up.rules</div><div class="line"> </div><div class="line">cat &gt;&gt;/etc/ppp/pptpd-options&lt;&lt;EOF</div><div class="line">pre-up iptables-restore &lt; /etc/iptables.up.rules</div><div class="line">post-down iptables-restore &lt; /etc/iptables.down.rules</div><div class="line">EOF</div><div class="line"> </div><div class="line">cat &gt;/etc/ppp/chap-secrets &lt;&lt;END</div><div class="line">yulingtianxia pptpd 123456 *</div><div class="line">802 pptpd 802 *</div><div class="line">END</div><div class="line"> </div><div class="line">service pptpd restart</div><div class="line"> </div><div class="line">netstat -lntp</div><div class="line"> </div><div class="line">exit 0</div></pre></td></tr></table></figure>
<p>在VPS上使用自动脚本只需要下面的操作：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">wget -c https://gist.githubusercontent.com/yulingtianxia/296b1b3b2edf5d762ae7/raw/e2ef1b18e85b393d22c82d26d72b20af14567e9c/pptp.sh</div><div class="line">chmod +x pptp.sh</div><div class="line">./pptp.sh</div></pre></td></tr></table></figure></p>
<p>上面的命令先是用ssh的wget命令下载gist上的原始Shell脚本文件到VPS上，速度之快和安全性是ftp上传所不能比拟的。然后赋予pptp.sh可执行权限，最后执行pptp.sh  </p>
</div></article><div class="pagination"><a href="/2014/07/11/2014-07-11-bitwise-and-overflow-operators-in-swift/" class="pagination-prev">PREV</a><a href="/2014/07/03/2014-07-03-chu-shi-core-data-3/" class="pagination-next">NEXT</a></div><div class="comments"></div></div><aside class="sidebar"><h3>分类标签</h3><ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/ARC/">ARC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/App-Extensions/">App Extensions</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/AppGroups/">AppGroups</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/">C</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CocoaPods/">CocoaPods</a></li></ul><h3>最新文章</h3><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2016/10/24/一首小诗/">1024,一首小诗</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/29/终有一天/">终有一天.md</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/14/樱花樱花想见你/">樱花樱花想见你</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/06/工具本/">小tips汇总</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/02/CI搭建和脚本自动化/">CI搭建和脚本自动化</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/01/又要春节了啊/">又要春节了啊</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/01/26/写给PM的iOS消息推送/">写给PM的iOS消息推送</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/01/19/gitlab和sourcetree的使用/">gitlab和sourcetree的使用</a></li></ul></aside></section></div><div class="extra"></div><footer class="footer"><div class="row-flex-row limit-width vh-center"><div class="copyright"><P>© 2017 <a href="/">sopig</P></div><div class="power"><p><a href="http://pinggod.com/">Sean Sun</a>, 
<a href="https://hexo.io">Hexo</a>, 
<a href="https://github.com/">GitHub</a>, 
<a href="https://jekyllrb.com/">Jekyll</a></p></div></div></footer><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></body></html>