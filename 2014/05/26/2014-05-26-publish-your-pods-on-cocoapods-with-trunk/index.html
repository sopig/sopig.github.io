<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Publish Your Pods on CocoaPods with Trunk · xiao</title><meta name="description" content="A Blog Powered By Hexo"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/jekyll.css"><!--[if lt IE 9]>
<script src="js/html5shiv.min.js"></script>
<script src="js/respond.min.js"></script>
<![endif]--></head><body><header class="row-flex-row limit-width vh-center"><a href="/" class="logo"><img src="/favicon.png"></a><nav><ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-link">Home</a></li><li class="nav-list-item"><a href="/archives/" class="nav-link active">   Blog</a></li><li class="nav-list-item"><a href="https://github.com/xxxxxx" target="_blank" class="nav-link">github</a></li><li class="nav-list-item"><a href="https://coding.net/u/xxxxxx" target="_blank" class="nav-link">coding</a></li><li class="nav-list-item"><a href="http://weibo.com/xxxxxx" target="_blank" class="nav-link">weibo</a></li><li class="nav-list-item"><a href="/atom.xml" class="nav-link">rss</a></li></ul></nav></header><div class="container limit-width"><section class="row-flex-row"><div class="post"><article class="post-block"><h2 class="post-title"><a href="/2014/05/26/2014-05-26-publish-your-pods-on-cocoapods-with-trunk/" class="post-title-link">Publish Your Pods on CocoaPods with Trunk</a></h2><div class="post-meta"><ul class="post-tag-list"><li class="post-tag-item"><a href="/tags/GitHub/" class="post-tag-link">GitHub</a></li><li class="post-tag-item"><a href="/tags/CocoaPods/" class="post-tag-link">CocoaPods</a></li></ul><div class="post-time">Monday, May 26th 2014</div></div><div class="post-content"><p>##简介</p>
<p>2014年5月20日，CocoaPods不再接受向<a href="git@github.com:CocoaPods/Specs.git">CocoaPods/Specs</a>的pull request，官方的说法是为了安全考虑，防止每个人的pod被其他人修改，于是CocoaPods团队开发了trunk服务，这样每个人都是其发布的pod的owner，没有权限的人无法修改，这样更安全。  </p>
<p>更改后的提交架构是这样的：(来自官方图片)  </p>
<p><img src="http://blog.cocoapods.org/assets/blog_img/trunk/architecture-diagram.png" alt="">  </p>
<a id="more"></a>
<p>以前的podspec文件都是ruby格式，而trunk为我们带来了更轻便的json格式，你后你可以用json来配置你的pod了。不用担心过去我们发布的pod，他们依然健在，并且trunk会将podspec文件转化为podspec.json文件。    </p>
<p>这里给出一个官方的介绍链接：<a href="http://blog.cocoapods.org/CocoaPods-Trunk/#transition" target="_blank" rel="external">http://blog.cocoapods.org/CocoaPods-Trunk/#transition</a>  </p>
<p><strong>废话不多说，简要介绍下如何使用trunk新建我们的pod：</strong>  </p>
<p>##开始注册<br>trunk需要CocoaPods 0.33版本以上，用<code>pod --version</code>命令查看版本，如果版本低，需要升级：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sudo gem install cocoapods</div><div class="line">pod setup</div></pre></td></tr></table></figure>
<p>然后会一直卡在<code>Setting up CocoaPods master repo</code>这里，这条命令用于跟新本地电脑上的保存的Pods依赖库tree。由于每天有很多人会创建或者更新Pods依赖库，这条命令执行的时候会相当慢，还请耐心等待。我们需要经常执行这条命令，否则有新的Pods依赖库的时候执行pod search命令是搜不出来的。再开启一个终端，通过<code>cd  ~/.cocoapods</code>命令进入cocoapods根目录，然后通过<code>du -sh *</code>命令查看总的文件大小，如果隔一阵子会增加，那么说明一切正常，下载速度取决于你的网络。  </p>
<p>更新完成后，下一步是注册trunk，这一步需要自备梯子，否则就会出现这种<a href="https://github.com/CocoaPods/CocoaPods/issues/2174" target="_blank" rel="external">问题</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pod trunk register yulingtianxia@gmail.com &apos;Yang Xiaoyu&apos; --description=&apos;macbook pro&apos; --verbose</div></pre></td></tr></table></figure>
<p>上面的命令是我注册时使用的，你需要把邮箱和名字以及描述替换成你的，加上<code>--verbose</code>可以输出详细debug信息，方便出错时查看。  </p>
<p>注册后CocoaPods会给你的邮箱发送验证链接，点击后就注册成功了，可以用<code>pod trunk me</code>命令查看自己的注册信息：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">bogon:YXYNumberAnimationLabel yangxiaoyu$ pod trunk me</div><div class="line">  - Name:     Yang Xiaoyu</div><div class="line">  - Email:    yulingtianxia@gmail.com</div><div class="line">  - Since:    May 25th, 20:27</div><div class="line">  - Sessions: </div><div class="line">    - May 25th, 20:27 - September 30th, 22:41. IP: 23.228.209.171</div><div class="line">  Description: macbook pro</div></pre></td></tr></table></figure>
<p>上面是我的注册信息，CocoaPods不通过密码来验证用户，而是通过一个session token。  </p>
<p>##部署你的Pod<br>首先你需要建立一个podspec文件，这是我的podspec文件：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">Pod::Spec.new do |s|</div><div class="line">  s.name         = &quot;YXYNumberAnimationLabel&quot;</div><div class="line">  s.version      = &quot;1.0.1&quot;</div><div class="line">  s.summary      = &quot;一个可以动起来的数字Label&quot;</div><div class="line">  s.description  = &lt;&lt;-DESC</div><div class="line">                    通过设置数字变化的插值来展现动画效果</div><div class="line">                   DESC</div><div class="line">  s.homepage     = &quot;https://github.com/yulingtianxia/YXYNumberAnimationLabel&quot;</div><div class="line">  </div><div class="line">  s.license      = &apos;MIT&apos;</div><div class="line">  s.author       = &#123; &quot;YangXiaoyu&quot; =&gt; &quot;yulingtianxia@gmail.com&quot; &#125;</div><div class="line">  s.social_media_url = &quot;http://twitter.com/yulingtianxia&quot;</div><div class="line">  s.source       = &#123; :git =&gt; &quot;https://github.com/yulingtianxia/YXYNumberAnimationLabel.git&quot;, :tag =&gt; s.version.to_s &#125;</div><div class="line"></div><div class="line">  s.platform     = :ios, &apos;6.0&apos;</div><div class="line">  s.requires_arc = true</div><div class="line"></div><div class="line">  s.source_files = &apos;YXYNumberAnimationLabel/*&apos;</div><div class="line">  s.frameworks = &apos;Foundation&apos;, &apos;UIKit&apos;</div><div class="line">  #s.private_header_files = &apos;Classes/ios/private/*.h&apos;</div><div class="line">  </div><div class="line">  #s.dependency &apos;FLKAutoLayout&apos;, &apos;~&gt; 0.1&apos;</div><div class="line">end</div></pre></td></tr></table></figure>
<p><strong>具体配置什么的大家走很熟悉，这里只是讲述使用trunk后需要注意的地方和新的操作</strong>  </p>
<p>在验证和上传你的podspec文件到trunk之前，需要将你的源码push到Github上，tag一个版本号并发布一个release版本，这样podspec文件中的<code>s.source</code>的值才能是准确的：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">git add -A &amp;&amp; git commit -m &quot;Release 1.0.1.&quot;  </div><div class="line">git tag &apos;1.0.1&apos;  </div><div class="line">git push --tags  </div><div class="line">git push origin master</div></pre></td></tr></table></figure>
<p>这两条命令是为pod添加版本号并打上tag:  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">set the new version to 1.0.1</div><div class="line">set the new tag to 1.0.1</div></pre></td></tr></table></figure>
<p>在你podspec文件下的路径运行<code>pod trunk push YXYNumberAnimationLabel.podspec</code> 命令，同样需要翻墙梯子自备，别忘了将<code>YXYNumberAnimationLabel.podspec</code>替换成你的podspec文件名。  </p>
<p>pod trunk push命令做了如下三个工作：  </p>
<ol>
<li>验证你本地的podspec文件（你也可以用<code>pod lib lint</code>命令来验证）</li>
<li>上传你的podspec文件到trunk</li>
<li>将你的podspec文件转化成trunk需要的JSON文件</li>
</ol>
<p>如果部署成功，CocosPods会在Twitter上@你  </p>
<p>就像文章最开始的架构图描述的那样，你在trunk中的操作依然会在<a href="git@github.com:CocoaPods/Specs.git">CocoaPods/Specs</a>仓库中更新。以后再做更改时只需要更新版本号然后通过trunk来提交，不用向<a href="git@github.com:CocoaPods/Specs.git">CocoaPods/Specs</a>pull request并等待审核和merge了。  </p>
<p>运行<code>pod setup</code>来更新你的Pods依赖库tree后，再使用<code>pod search YXYNumberAnimationLabel</code>命令来查找刚刚加入的名字叫<code>YXYNumberAnimationLabel</code>的依赖库：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">-&gt; YXYNumberAnimationLabel (1.0.1)</div><div class="line">   一个可以动起来的数字Label</div><div class="line">   pod &apos;YXYNumberAnimationLabel&apos;, &apos;~&gt; 1.0.1&apos;</div><div class="line">   - Homepage: https://github.com/yulingtianxia/YXYNumberAnimationLabel</div><div class="line">   - Source:   https://github.com/yulingtianxia/YXYNumberAnimationLabel.git</div><div class="line">   - Versions: 1.0.1, 1.0.0 [master repo]</div></pre></td></tr></table></figure>
<p>##将其他人加入到你的Pod</p>
<p>为了让其他人也有权限来和你一起建设你的代码，你需要运行下面的命令来赋予别人权限，假如我将<code>kyle@cocoapods.org</code>加入到我的名字叫<code>ARAnalytics</code>的库中，我需要运行下面的命令：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pod trunk add-owner ARAnalytics kyle@cocoapods.org</div></pre></td></tr></table></figure>
</div></article><div class="pagination"><a href="/2014/06/16/2014-06-16-swiftzhong-zai-yun-suan-fu/" class="pagination-prev">PREV</a><a href="/2014/05/12/2014-05-12-objective-czhong-de-kvche-kvo/" class="pagination-next">NEXT</a></div><div class="comments"></div></div><aside class="sidebar"><h3>分类标签</h3><ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/ARC/">ARC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/App-Extensions/">App Extensions</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/AppGroups/">AppGroups</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/">C</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CocoaPods/">CocoaPods</a></li></ul><h3>最新文章</h3><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2016/10/24/一首小诗/">1024,一首小诗</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/29/终有一天/">终有一天.md</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/14/樱花樱花想见你/">樱花樱花想见你</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/06/工具本/">小tips汇总</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/02/CI搭建和脚本自动化/">CI搭建和脚本自动化</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/01/又要春节了啊/">又要春节了啊</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/01/26/写给PM的iOS消息推送/">写给PM的iOS消息推送</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/01/19/gitlab和sourcetree的使用/">gitlab和sourcetree的使用</a></li></ul></aside></section></div><div class="extra"></div><footer class="footer"><div class="row-flex-row limit-width vh-center"><div class="copyright"><P>© 2017 <a href="/">sopig</P></div><div class="power"><p><a href="http://pinggod.com/">Sean Sun</a>, 
<a href="https://hexo.io">Hexo</a>, 
<a href="https://github.com/">GitHub</a>, 
<a href="https://jekyllrb.com/">Jekyll</a></p></div></div></footer><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-80781234-1",'auto');ga('send','pageview');</script><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "//hm.baidu.com/hm.js?ee75cf111111aa99f8540efa2570970";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></body></html>